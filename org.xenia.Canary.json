{
  "app-id": "org.xenia.Canary",
  "runtime": "org.freedesktop.Platform",
  "runtime-version": "23.08",
  "sdk": "org.freedesktop.Sdk",
  "command": "xenia-canary",
  "modules": [
    {
      "name": "xenia-canary",
      "buildsystem": "simple",
      "build-commands": [
        "git clone --recursive --branch canary_experimental https://github.com/xenia-canary/xenia-canary.git",
        "cd xenia-canary && python3 xenia-build setup --target_os=linux",
        "python3 xb premake --cc gcc",
        "python3 xb build --config=release",
        "install -Dm755 build/bin/Linux/Release/xenia-canary $FLATPAK_DEST/bin/xenia-canary",
        "install -Dm644 assets/icon/256.png $FLATPAK_DEST/share/icons/hicolor/256x256/apps/xenia.png",
        "install -Dm644 Xenia-canary.desktop $FLATPAK_DEST/share/applications/org.xenia.Canary.desktop"
      ],
      "sources": [
        {
          "type": "file",
          "url": "https://github.com/xenia-project/xenia/blob/master/assets/icon/256.png?raw=true",
          "dest-filename": "xenia.png",
          "sha256": "a1686a9d50baad70a5658e0a2cb38a34f7c96fa41f5beebb81bcf405355b712f"
        },
        {
          "type": "file",
          "path": "org.xenia.Canary.desktop"
        }
      ],
      "finish-args": [
        "--device=all",
        "--filesystem=home:ro",
        "--filesystem=/media",
        "--filesystem=/run/media",
        "--share=ipc",
        "--socket=fallback-x11",
        "--socket=pulseaudio",
        "--socket=wayland",
        "--share=network",
        "--talk-name=org.freedesktop.ScreenSaver",
        "--talk-name=org.mate.ScreenSaver",
        "--socket=gpu",
        "--share=alsa"
      ]
    }
  ],
  "runtime-repo": "https://dl.flathub.org/repo/flathub.flatpakrepo"
}
